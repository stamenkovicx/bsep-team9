<div class="reset-password-container">
    <mat-card class="reset-password-card">
      
      <mat-card-header>
        <mat-icon mat-card-avatar>lock_open</mat-icon>
        <mat-card-title>Reset Password</mat-card-title>
        <mat-card-subtitle>Enter your new password</mat-card-subtitle>
      </mat-card-header>
      
      <mat-card-content>
        
        <!-- Success Message -->
        <div class="success-message" *ngIf="successMessage">
          <mat-icon>check_circle</mat-icon>
          <p>{{ successMessage }}</p>
          <p class="redirect-info">Redirecting to login...</p>
        </div>
  
        <!-- Error Message -->
        <div class="error-message" *ngIf="errorMessage">
          <mat-icon>error</mat-icon>
          <p>{{ errorMessage }}</p>
        </div>
  
        <form class="reset-password-form" [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()" *ngIf="!successMessage && token">
          
          <mat-form-field appearance="outline">
            <mat-label>New Password</mat-label>
            <input matInput formControlName="newPassword" type="password">
            <mat-icon matSuffix>vpn_key</mat-icon>
            <mat-error *ngIf="resetPasswordForm.get('newPassword')?.invalid && resetPasswordForm.get('newPassword')?.touched">
              Password must be at least 8 characters long.
            </mat-error>
          </mat-form-field>
  
          <mat-form-field appearance="outline">
            <mat-label>Confirm Password</mat-label>
            <input matInput formControlName="confirmPassword" type="password">
            <mat-icon matSuffix>vpn_key</mat-icon>
            <mat-error *ngIf="resetPasswordForm.get('confirmPassword')?.invalid && resetPasswordForm.get('confirmPassword')?.touched">
              Please confirm your password.
            </mat-error>
          </mat-form-field>

          <!-- PROMENI OVO -->
            <div class="password-match-indicator" *ngIf="resetPasswordForm.get('confirmPassword')?.value">
                <div class="match-message" [ngClass]="{'match': passwordsMatch(), 'no-match': !passwordsMatch()}">
                <mat-icon>{{ passwordsMatch() ? 'check_circle' : 'cancel' }}</mat-icon>
                <span>{{ passwordsMatch() ? 'Passwords match' : 'Passwords do not match' }}</span>
                </div>
            </div>
          
          <button 
            class="submit-button" 
            color="primary" 
            type="submit" 
            mat-raised-button 
            [disabled]="resetPasswordForm.invalid || isLoading">
            <span *ngIf="!isLoading">Reset Password</span>
            <span *ngIf="isLoading">Resetting...</span>
          </button>
  
          <button 
            class="back-button" 
            type="button" 
            mat-stroked-button 
            (click)="goToLogin()">
            Back to Login
          </button>
          
        </form>
      </mat-card-content>
    </mat-card>
  </div>