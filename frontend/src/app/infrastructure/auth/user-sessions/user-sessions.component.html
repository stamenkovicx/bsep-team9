<div class="sessions-container">
  <div class="header">
    <h2>Active Sessions</h2>
    <p class="subtitle">Manage your active login sessions across different devices and browsers</p>
  </div>

  <div class="actions" *ngIf="sessions.length > 0">
    <button mat-raised-button color="warn" (click)="revokeAllSessions()" 
            [disabled]="getOtherSessionsCount() === 0">
      <mat-icon>logout</mat-icon>
      Revoke All Other Sessions
    </button>
    <button mat-button (click)="loadSessions()" [disabled]="loading">
      <mat-icon>refresh</mat-icon>
      Refresh
    </button>
  </div>

  <div class="error-message" *ngIf="errorMessage">
    <mat-icon>error</mat-icon>
    {{ errorMessage }}
  </div>

  <div class="loading" *ngIf="loading">
    <mat-spinner diameter="40"></mat-spinner>
    <p>Loading sessions...</p>
  </div>

  <div class="no-sessions" *ngIf="!loading && sessions.length === 0">
    <mat-icon>info</mat-icon>
    <p>No active sessions found</p>
  </div>

  <div class="sessions-table" *ngIf="!loading && sessions.length > 0">
    <table mat-table [dataSource]="dataSource" class="mat-elevation-z2">
      
      <!-- Device Type Column -->
      <ng-container matColumnDef="deviceType">
        <th mat-header-cell *matHeaderCellDef>Device</th>
        <td mat-cell *matCellDef="let session">
          <div class="device-info">
            <span class="device-icon">{{ getDeviceIcon(session.deviceType) }}</span>
            <span>{{ session.deviceType }}</span>
          </div>
        </td>
      </ng-container>

      <!-- Browser Column -->
      <ng-container matColumnDef="browserName">
        <th mat-header-cell *matHeaderCellDef>Browser</th>
        <td mat-cell *matCellDef="let session">
          <div class="browser-info">
            <span class="browser-icon">{{ getBrowserIcon(session.browserName) }}</span>
            <span>{{ session.browserName }}</span>
          </div>
        </td>
      </ng-container>

      <!-- IP Address Column -->
      <ng-container matColumnDef="ipAddress">
        <th mat-header-cell *matHeaderCellDef>IP Address</th>
        <td mat-cell *matCellDef="let session">{{ session.ipAddress }}</td>
      </ng-container>

      <!-- Last Activity Column -->
      <ng-container matColumnDef="lastActivity">
        <th mat-header-cell *matHeaderCellDef>Last Activity</th>
        <td mat-cell *matCellDef="let session">
          <div class="activity-info">
            <span class="activity-time">{{ formatDate(session.lastActivity) }}</span>
            <span class="current-session" *ngIf="session.isCurrentSession">
              <mat-icon>radio_button_checked</mat-icon>
              Current
            </span>
          </div>
        </td>
      </ng-container>

      <!-- Created At Column -->
      <ng-container matColumnDef="createdAt">
        <th mat-header-cell *matHeaderCellDef>Created</th>
        <td mat-cell *matCellDef="let session">{{ formatDate(session.createdAt) }}</td>
      </ng-container>

      <!-- Current Session Column -->
      <ng-container matColumnDef="isCurrentSession">
        <th mat-header-cell *matHeaderCellDef>Status</th>
        <td mat-cell *matCellDef="let session">
          <span class="session-status" [class.current]="session.isCurrentSession" [class.other]="!session.isCurrentSession">
            {{ session.isCurrentSession ? 'Current' : 'Other' }}
          </span>
        </td>
      </ng-container>

      <!-- Actions Column -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let session">
          <button mat-icon-button color="warn" 
                  (click)="revokeSession(session)"
                  [disabled]="session.isCurrentSession"
                  matTooltip="Revoke this session">
            <mat-icon>logout</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;" 
          [class.current-session-row]="row.isCurrentSession"></tr>
    </table>
  </div>

  <div class="info-section">
    <mat-card>
      <mat-card-header>
        <mat-card-title>
          <mat-icon>info</mat-icon>
          Session Security Information
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <ul>
          <li>Each session represents a login from a different device or browser</li>
          <li>You can revoke individual sessions if you suspect unauthorized access</li>
          <li>Revoking a session will immediately log out that device</li>
          <li>Your current session cannot be revoked from this page</li>
          <li>Sessions automatically expire after 24 hours of inactivity</li>
        </ul>
      </mat-card-content>
    </mat-card>
  </div>
</div>
